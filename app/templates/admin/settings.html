<!-- app/templates/admin/settings.html -->
{% extends "admin/base.html" %}

{% block title %}Settings{% endblock %}

{% block content %}
<div class="mb-6">
    <h2 class="text-2xl font-bold text-wireframe-800 mb-2">SYSTEM SETTINGS</h2>
    <p class="text-wireframe-600">Configure application settings and preferences</p>
</div>

<form method="POST" class="space-y-8">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <!-- General Settings -->
    <div class="wireframe-border bg-white rounded-lg">
        <div class="p-6 border-b border-wireframe-200">
            <h3 class="text-lg font-bold text-wireframe-800">GENERAL CONFIGURATION</h3>
        </div>
        <div class="p-6 space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-wireframe-700 mb-2">Site Name</label>
                    <input type="text" name="site_name" value="{{ settings['site_name'] }}" 
                           class="w-full px-3 py-2 wireframe-border text-wireframe-800">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-wireframe-700 mb-2">Site Description</label>
                    <input type="text" name="site_description" value="{{ settings['site_description'] }}" 
                           class="w-full px-3 py-2 wireframe-border text-wireframe-800">
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-wireframe-700 mb-2">Items per Page</label>
                    <select name="items_per_page" class="w-full px-3 py-2 wireframe-border text-wireframe-800">
                        {% for option in [10,20,50,100] %}
                            <option value="{{ option }}" {% if settings['items_per_page'] == option|string %}selected{% endif %}>{{ option }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-wireframe-700 mb-2">Default Timezone</label>
                    <select name="timezone" class="w-full px-3 py-2 wireframe-border text-wireframe-800">
                        {% for tz in ["UTC","Europe/Paris","America/New_York","Asia/Tokyo"] %}
                            <option value="{{ tz }}" {% if settings['timezone'] == tz %}selected{% endif %}>{{ tz }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- User Management Settings -->
    <div class="wireframe-border bg-white rounded-lg">
        <div class="p-6 border-b border-wireframe-200">
            <h3 class="text-lg font-bold text-wireframe-800">USER MANAGEMENT</h3>
        </div>
        <div class="p-6 space-y-6">
            <div class="flex items-center space-x-3">
                <input type="checkbox" id="allow_registration" name="allow_registration" 
                       {% if settings['allow_registration'] == 'on' %}checked{% endif %} class="wireframe-border">
                <label for="allow_registration">Allow new user registration</label>
            </div>
            
            <div class="flex items-center space-x-3">
                <input type="checkbox" id="require_email_verification" name="require_email_verification" 
                       {% if settings['require_email_verification'] == 'on' %}checked{% endif %} class="wireframe-border">
                <label for="require_email_verification">Require email verification</label>
            </div>
            
            <div class="flex items-center space-x-3">
                <input type="checkbox" id="auto_approve_ideas" name="auto_approve_ideas" 
                       {% if settings['auto_approve_ideas'] == 'on' %}checked{% endif %} class="wireframe-border">
                <label for="auto_approve_ideas">Auto-approve new ideas</label>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-wireframe-700 mb-2">Maximum ideas per user</label>
                <input type="number" name="max_ideas_per_user" value="{{ settings['max_ideas_per_user'] }}" min="1" 
                       class="w-32 px-3 py-2 wireframe-border text-wireframe-800">
            </div>
        </div>
    </div>

    <!-- Security Settings -->
    <div class="wireframe-border bg-white rounded-lg">
        <div class="p-6 border-b border-wireframe-200">
            <h3 class="text-lg font-bold text-wireframe-800">SECURITY & PRIVACY</h3>
        </div>
        <div class="p-6 space-y-6">
            <div class="flex items-center space-x-3">
                <input type="checkbox" id="enable_2fa" name="enable_2fa" 
                       {% if settings['enable_2fa'] == 'on' %}checked{% endif %} class="wireframe-border">
                <label for="enable_2fa">Enable Two-Factor Authentication</label>
            </div>
            
            <div class="flex items-center space-x-3">
                <input type="checkbox" id="log_user_activity" name="log_user_activity" 
                       {% if settings['log_user_activity'] == 'on' %}checked{% endif %} class="wireframe-border">
                <label for="log_user_activity">Log user activity</label>
            </div>
            
            <div>
                <label>Session timeout (minutes)</label>
                <input type="number" name="session_timeout" value="{{ settings['session_timeout'] }}" min="5" max="1440" 
                       class="w-32 px-3 py-2 wireframe-border text-wireframe-800">
            </div>
            
            <div>
                <label>Password minimum length</label>
                <input type="number" name="password_min_length" value="{{ settings['password_min_length'] }}" min="6" max="50" 
                       class="w-32 px-3 py-2 wireframe-border text-wireframe-800">
            </div>
        </div>
    </div>

    <!-- Notification Settings -->
    <div class="wireframe-border bg-white rounded-lg">
        <div class="p-6 border-b border-wireframe-200">
            <h3 class="text-lg font-bold text-wireframe-800">NOTIFICATIONS</h3>
        </div>
        <div class="p-6 space-y-6">
            <div class="flex items-center space-x-3">
                <input type="checkbox" id="email_notifications" name="email_notifications" 
                       {% if settings['email_notifications'] == 'on' %}checked{% endif %} class="wireframe-border">
                <label for="email_notifications">Send email notifications</label>
            </div>
            
            <div class="flex items-center space-x-3">
                <input type="checkbox" id="admin_alerts" name="admin_alerts" 
                       {% if settings['admin_alerts'] == 'on' %}checked{% endif %} class="wireframe-border">
                <label for="admin_alerts">Admin alerts</label>
            </div>
            
            <div>
                <label>Admin Email</label>
                <input type="email" name="admin_email" value="{{ settings['admin_email'] }}" 
                       class="w-full max-w-md px-3 py-2 wireframe-border text-wireframe-800">
            </div>
        </div>
    </div>

    <!-- Backup & Maintenance -->
    <div class="wireframe-border bg-white rounded-lg">
        <div class="p-6 border-b border-wireframe-200">
            <h3 class="text-lg font-bold text-wireframe-800">BACKUP & MAINTENANCE</h3>
        </div>
        <div class="p-6 space-y-6">
            <div class="flex items-center space-x-3">
                <input type="checkbox" id="auto_backup" name="auto_backup" 
                       {% if settings['auto_backup'] == 'on' %}checked{% endif %} class="wireframe-border">
                <label for="auto_backup">Enable automatic backups</label>
            </div>
            
            <div>
                <label>Backup frequency</label>
                <select name="backup_frequency" class="w-48 px-3 py-2 wireframe-border text-wireframe-800">
                    {% for freq in ["daily","weekly","monthly"] %}
                        <option value="{{ freq }}" {% if settings['backup_frequency'] == freq %}selected{% endif %}>{{ freq|capitalize }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="flex space-x-4">
                <button type="button" onclick="createBackup()" 
                        class="px-4 py-2 bg-wireframe-600 text-white text-sm">CREATE BACKUP NOW</button>
                <button type="button" onclick="showMaintenanceMode()" 
                        class="px-4 py-2 bg-orange-600 text-white text-sm">MAINTENANCE MODE</button>
            </div>
        </div>
    </div>

    <!-- Save/Reset -->
    <div class="flex justify-end space-x-4">
        <button type="submit" name="reset"
                class="px-6 py-3 bg-wireframe-200 text-wireframe-800 font-medium hover:bg-wireframe-300 wireframe-border">
            RESET TO DEFAULT
        </button>
        <button type="submit" 
                class="px-6 py-3 bg-wireframe-800 text-white font-medium hover:bg-wireframe-700 wireframe-border">
            SAVE SETTINGS
        </button>
    </div>
</form>

<!-- Maintenance Modal (inchangÃ©, tu gardes le JS) -->
{% endblock %}

{% block scripts %}
<script>
    function createBackup() {
        const button = event.target;
        const originalText = button.textContent;
        
        button.textContent = 'CREATING BACKUP...';
        button.disabled = true;
        
        // Simulate backup creation
        setTimeout(() => {
            button.textContent = originalText;
            button.disabled = false;
            
            showNotification('Backup created successfully', 'success');
        }, 3000);
    }
    
    function showMaintenanceMode() {
        document.getElementById('maintenanceModal').classList.remove('hidden');
    }
    
    function closeMaintenanceModal() {
        document.getElementById('maintenanceModal').classList.add('hidden');
    }
    
    function enableMaintenanceMode() {
        const message = document.getElementById('maintenanceMessage').value;
        const duration = document.getElementById('maintenanceDuration').value;
        
        if (confirm(`Are you sure you want to enable maintenance mode for ${duration} hours?`)) {
            // In a real implementation, you would send this to your backend
            console.log('Maintenance mode enabled:', { message, duration });
            
            closeMaintenanceModal();
            showNotification('Maintenance mode enabled', 'warning');
        }
    }

</script>

{% endblock %}